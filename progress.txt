# Ralph Progress Log
Started: Sun Jan 25 19:41:36 EST 2026

## Codebase Patterns
- Use `pnpm nx generate @nx/next:application` to create new Next.js apps
- Apps follow the pattern of: package.json (with workspace deps), tsconfig.json (with ~/\* paths), project.json (with dev and vercel targets)
- Dark mode styling uses bg-slate-900 text-slate-100
- Convex backend lives in apps/<app>/convex/ with its own tsconfig.json
- Styles: create src/styles/global.css importing tailwindcss and component-library globals
- PostCSS: use @tailwindcss/postcss plugin
- next.config.ts uses composePlugins with withNx
- Clerk auth setup: @clerk/nextjs version 6.32.0, middleware.ts uses clerkMiddleware() with createRouteMatcher, layout wraps with ClerkProvider via providers.tsx
- Sign-in/sign-up pages use catch-all routes [[...sign-in]] and [[...sign-up]] for Clerk's multi-step flows
- Environment validation: use @t3-oss/env-nextjs with zod for type-safe env vars

---

## 2026-01-25 - US-001
- Created Next.js application at apps/trade-tracker/
- Initialized Convex backend at apps/trade-tracker/convex/ with empty schema
- Created dark mode layout.tsx with bg-slate-900 text-slate-100
- Created placeholder home page at src/app/page.tsx
- Build and lint pass successfully

**Files created/changed:**
- apps/trade-tracker/package.json
- apps/trade-tracker/project.json
- apps/trade-tracker/tsconfig.json
- apps/trade-tracker/next.config.ts
- apps/trade-tracker/postcss.config.mjs
- apps/trade-tracker/.swcrc
- apps/trade-tracker/eslint.config.mjs
- apps/trade-tracker/index.d.ts
- apps/trade-tracker/next-env.d.ts
- apps/trade-tracker/public/.gitkeep
- apps/trade-tracker/public/favicon.ico
- apps/trade-tracker/src/app/layout.tsx
- apps/trade-tracker/src/app/page.tsx
- apps/trade-tracker/src/styles/global.css
- apps/trade-tracker/convex/schema.ts
- apps/trade-tracker/convex/tsconfig.json

**Learnings for future iterations:**
- The nx generator creates next.config.js by default; convert it to next.config.ts for consistency
- tsconfig.json needs to include convex/**/*.ts in the include array
- Reference the component-library in tsconfig.json references array
- The schema.ts can be empty initially (defineSchema({})) - it will be populated in later stories

---

## 2026-01-25 - US-002
- Added Clerk authentication to trade-tracker app
- Installed @clerk/nextjs, @t3-oss/env-nextjs, and zod packages
- Created middleware.ts protecting all routes except /sign-in and /sign-up
- Created providers.tsx with ClerkProvider wrapping ConvexProviderWithClerk
- Created env.ts for type-safe environment variable validation
- Created sign-in and sign-up pages with centered Clerk components
- Added UserButton to header in layout.tsx
- TypeScript and lint checks pass

**Files created/changed:**
- apps/trade-tracker/package.json (added dependencies)
- apps/trade-tracker/src/middleware.ts (new)
- apps/trade-tracker/src/env.ts (new)
- apps/trade-tracker/src/app/providers.tsx (new)
- apps/trade-tracker/src/app/layout.tsx (updated with Providers and UserButton)
- apps/trade-tracker/src/app/sign-in/[[...sign-in]]/page.tsx (new)
- apps/trade-tracker/src/app/sign-up/[[...sign-up]]/page.tsx (new)

**Learnings for future iterations:**
- Clerk middleware uses createRouteMatcher for route protection, not string arrays
- Catch-all routes [[...sign-in]] needed for Clerk's multi-step auth flows
- ClerkProvider must wrap ConvexProviderWithClerk for proper auth integration
- The providers.tsx pattern separates client components from server layout

---

## 2026-01-25 - US-003
- Defined trades table schema in apps/trade-tracker/convex/schema.ts
- Added all required fields: date, ticker, assetType, side, direction, price, quantity, campaignId, notes
- Added three indexes: by_campaignId, by_ticker, by_date
- Fields use alphabetized object keys per monorepo conventions
- TypeScript and lint checks pass

**Files changed:**
- apps/trade-tracker/convex/schema.ts (updated with trades table definition)
- apps/trade-tracker/convex/tsconfig.json (restored after accidental deletion)

**Learnings for future iterations:**
- Convex schema uses v.union(v.literal("value1"), v.literal("value2")) for string union types
- Optional fields use v.optional(v.id("tableName")) or v.optional(v.string())
- Indexes are chained with .index("name", ["field"]) after defineTable()
- Always alphabetize object keys in schema definitions

---
